class Subject {
    constructor () {
        this.id = guid();
        this.name = null;
        this.links = [];
    }
    setId(id) {
        this.id = id;
    }
    setName (name) {
        this.name = name;
    }
    setUrl (name, url) {
        var links = this.links;
        links.push({name, url});
        this.links = links;
    }
    getData() {
        return this;
    }
}

class Event {
    constructor () {
        this.id = guid();
        this.subject = null;
        this.attendant = null;
        this.time = {
            start: null,
            end: null
        };
        this.days = [];
    }
    setId(id) {
        this.id = id;
    }
    setSubject(subject) {
        this.subject = subject;
    }
    setAttendant(attendant) {
        this.attendant = attendant;
    }
    setTime(start, end) {
        this.time = {
            start,
            end
        };
    }
    setDays(days) {
        this.days = days;
    }
    getData() {
        return this;
    }
}

function getEvents(day = null) {
    var data = localStorage.events;
    if (data) {
        data = JSON.parse(data);
    } else {
        data = {};
        localStorage.events = JSON.stringify(data);
    }
    for (id in data) {
        var event = data[id];
        if (event !== null) {
            event.subject = getSubjects(event._subject);
            event.attendant = getAttendats(event._attendant);
            data[id] = event;
        }
    }
    if (day != null) {
        var today = [];
        for (id in data) {
            var event = data[id];
            if (event.days.includes(parseInt(day))) {
                today.push(event);
            }
        }
        return today;
    } else {
        return data;
    }
}

function getAttendats(id = null) {
    var data = localStorage.attendants;
    if (data) {
        data = JSON.parse(data);
    } else {
        data = [];
        localStorage.attendants = JSON.stringify(data);
    }
    return id != null ? data[id] : data;
}
function getSubjects(id) {
    var data = localStorage.subjects;
    if (data) {
        data = JSON.parse(data);
    } else {
        data = [];
        localStorage.subjects = JSON.stringify(data);
    }
    return id != null ? data[id] : data;
}

function getSubjects_(){
    var data = localStorage.subjects
    return JSON.parse(data);
}